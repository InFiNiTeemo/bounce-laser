import { ctx } from '../core/render.js';
import { COLORS, SHIELD_RADIUS } from '../core/constants.js';
import { game, player } from '../core/state.js';

export function drawShield() { if(!game.shieldActive)return; const p=player,r=SHIELD_RADIUS,er=game.shieldEnergy/game.shieldMaxEnergy; if(er<0.25&&Math.floor(Date.now()/80)%2===0)return; ctx.save(); ctx.beginPath();ctx.arc(p.x,p.y,r,0,Math.PI*2);ctx.fillStyle=`rgba(0,200,255,${0.08+er*0.07})`;ctx.fill(); ctx.strokeStyle=`rgba(0,220,255,${0.15+er*0.15})`; ctx.lineWidth=1; const hs=10; for(let hx=p.x-r;hx<p.x+r;hx+=hs*1.5)for(let hy=p.y-r;hy<p.y+r;hy+=hs*1.73){const ox=(Math.floor((hy-p.y+r)/(hs*1.73))%2)*hs*0.75,cx=hx+ox,cy=hy;if(Math.hypot(cx-p.x,cy-p.y)>r-4)continue;ctx.beginPath();for(let i=0;i<6;i++){const a=Math.PI/3*i-Math.PI/6,vx=cx+Math.cos(a)*hs*0.5,vy=cy+Math.sin(a)*hs*0.5;if(i===0)ctx.moveTo(vx,vy);else ctx.lineTo(vx,vy);}ctx.closePath();ctx.stroke();} ctx.shadowColor=COLORS.shieldGlow;ctx.shadowBlur=15;ctx.beginPath();ctx.arc(p.x,p.y,r,0,Math.PI*2);ctx.strokeStyle=COLORS.shield;ctx.lineWidth=2;ctx.globalAlpha=0.6+er*0.4;ctx.stroke();ctx.shadowBlur=0; ctx.beginPath();ctx.arc(p.x,p.y,r-3,0,Math.PI*2);ctx.strokeStyle=`rgba(0,238,255,${0.2+er*0.2})`;ctx.lineWidth=1;ctx.stroke(); ctx.globalAlpha=1;ctx.restore(); }
